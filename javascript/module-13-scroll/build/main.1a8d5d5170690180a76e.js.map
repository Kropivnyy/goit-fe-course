{"version":3,"sources":["webpack:///./js/refs.js","webpack:///./js/api-service.js","webpack:///./js/lightbox.js","webpack:///./js/masonry-service.js","webpack:///./js/infinite-scroll.js","webpack:///./js/get-item-html.js","webpack:///./js/micro-template.js","webpack:///./js/fetch-handling.js","webpack:///./index.js"],"names":["input","document","querySelector","form","findButton","itemTemplate","grid","searchQuery","foundImages","resetResult","this","value","items","lightboxRef","instance","basicLightbox","showModal","event","show","src","target","dataset","source","closeModal","key","close","findImageIndex","apiService","findIndex","image","urls","regular","changeImage","imageIndex","elem","find","item","index","showNextImage","currentImageIndex","length","showPrevImage","msnry","initMasonry","Masonry","itemSelector","columnWidth","gutter","percentPosition","stagger","visibleStyle","transform","opacity","hiddenStyle","resetMasonry","infScroll","InfiniteScroll","path","baseURL","pageIndex","responseType","outlayer","masonryService","status","history","resetPage","templateHTML","refs","innerHTML","getItemHTML","photo","data","replace","match","split","forEach","part","imagesLoaded","proxyElem","createElement","on","res","response","results","JSON","parse","itemsHTML","map","join","querySelectorAll","appendItems","appended","fetchHandling","result","addEventListener","preventDefault","query","toLowerCase","reset","options","loadNextPage","lightbox"],"mappings":"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","file":"main.1a8d5d5170690180a76e.js","sourcesContent":["export default {\r\n  input: document.querySelector('#query'),\r\n  form: document.querySelector('#search-form'),\r\n  findButton: document.querySelector('.find-button'),\r\n  itemTemplate: document.querySelector('#photo-item-template'),\r\n  grid: document.querySelector('.grid'),\r\n};\r\n\r\n","export default {\r\n  searchQuery: '',\r\n  foundImages: [],\r\n  resetResult() {\r\n    this.foundImages = [];\r\n  },\r\n  get query() {\r\n    return this.searchQuery;\r\n  },\r\n  set query(value) {\r\n    return (this.searchQuery = value);\r\n  },\r\n  get result() {\r\n    return this.foundImages;\r\n  },\r\n  set result(items) {\r\n    this.foundImages = [...this.foundImages, ...items];\r\n  },\r\n};\r\n","import * as basicLightbox from 'basiclightbox';\r\nimport apiService from './api-service';\r\n\r\nexport default {\r\n  lightboxRef: null,\r\n  instance: basicLightbox.create(\r\n    `<img class=\"lightbox__image\" src=\"\" alt=\"\" />`,\r\n  ),\r\n\r\n  showModal(event) {\r\n    this.instance.show();\r\n    this.lightboxRef = document.querySelector('.lightbox__image');\r\n    this.lightboxRef.src = event.target.dataset.source;\r\n  },\r\n\r\n  closeModal(event) {\r\n    if (event.key === 'Escape') {\r\n      this.instance.close();\r\n    }\r\n  },\r\n  findImageIndex() {\r\n    return apiService.foundImages.findIndex(\r\n      image => image.urls.regular === this.lightboxRef.src,\r\n    );\r\n  },\r\n  changeImage(imageIndex) {\r\n    const elem = apiService.foundImages.find((item, index) => {\r\n      if (imageIndex === index) return item;\r\n    });\r\n    this.lightboxRef.src = elem.urls.regular;\r\n  },\r\n  showNextImage(event) {\r\n    if (event.key === 'ArrowRight') {\r\n      let currentImageIndex = this.findImageIndex();\r\n      let nextImageIndex = currentImageIndex + 1;\r\n      nextImageIndex >= apiService.foundImages.length\r\n        ? (currentImageIndex = 0)\r\n        : (currentImageIndex += 1);\r\n      this.changeImage(currentImageIndex);\r\n    }\r\n  },\r\n  showPrevImage(event) {\r\n    if (event.key === 'ArrowLeft') {\r\n      let currentImageIndex = this.findImageIndex();\r\n      let prevImageIndex = currentImageIndex - 1;\r\n      prevImageIndex < 0\r\n        ? (currentImageIndex = apiService.foundImages.length - 1)\r\n        : (currentImageIndex -= 1);\r\n      this.changeImage(currentImageIndex);\r\n    }\r\n  },\r\n};\r\n","import Masonry from 'masonry-layout';\r\n\r\nexport default {\r\n  msnry: {},\r\n  initMasonry() {\r\n    this.msnry = new Masonry('.grid', {\r\n      itemSelector: '.photo-item',\r\n      columnWidth: '.grid__col-sizer',\r\n      gutter: '.grid__gutter-sizer',\r\n      percentPosition: true,\r\n      stagger: 30,\r\n      visibleStyle: { transform: 'translateY(0)', opacity: 1 },\r\n      hiddenStyle: { transform: 'translateY(100px)', opacity: 0 },\r\n    });\r\n  },\r\n  resetMasonry() {\r\n    this.msnry = {};\r\n  },\r\n};\r\n","import InfiniteScroll from 'infinite-scroll';\r\nimport masonryService from './masonry-service';\r\nimport apiService from './api-service';\r\n\r\nconst baseURL = 'https://api.unsplash.com/search/photos';\r\nconst apiKey = 'x9AhgqdVedkj92knzoynGC04XskWUCMDGAsuL6NaIdM';\r\n\r\nconst infScroll = new InfiniteScroll('.grid', {\r\n  path: function () {\r\n    return `${baseURL}?client_id=${apiKey}&query=${apiService.searchQuery}&page=${this.pageIndex}&per_page=12&order_by=popular`;\r\n  },\r\n  responseType: 'text',\r\n  outlayer: masonryService.msnry,\r\n  status: '.page-load-status',\r\n  history: false,\r\n  resetPage() {\r\n    infScroll.pageIndex = 1;\r\n  },\r\n});\r\n\r\nexport { infScroll };\r\n","import refs from './refs';\r\nimport microTemplate from './micro-template';\r\n\r\nconst templateHTML = refs.itemTemplate.innerHTML;\r\n\r\nexport default function getItemHTML(photo) {\r\n  return microTemplate(templateHTML, photo);\r\n}\r\n","export default function microTemplate(src, data) {\r\n  return src.replace(/\\{\\{([\\w\\-_\\.]+)\\}\\}/gi, function (match, key) {\r\n    var value = data;\r\n    key.split('.').forEach(function (part) {\r\n      value = value[part];\r\n    });\r\n    return value;\r\n  });\r\n}\r\n","import { infScroll } from './infinite-scroll';\r\nimport imagesLoaded from 'imagesloaded';\r\nimport getItemHTML from './get-item-html';\r\nimport InfiniteScroll from 'infinite-scroll';\r\nimport masonryService from './masonry-service';\r\n\r\nInfiniteScroll.imagesLoaded = imagesLoaded;\r\nconst proxyElem = document.createElement('div');\r\n\r\nexport default function fetchHandling(response) {\r\n  const { results } = JSON.parse(response);\r\n  const itemsHTML = results.map(getItemHTML).join('');\r\n  proxyElem.innerHTML = itemsHTML;\r\n  const items = proxyElem.querySelectorAll('.photo-item');\r\n  imagesLoaded(items, function () {\r\n    infScroll.appendItems(items);\r\n    masonryService.msnry.appended(items);\r\n  });\r\n  return results;\r\n}\r\n","import './styles.css';\nimport '../node_modules/basiclightbox/dist/basicLightbox.min.css';\nimport refs from './js/refs';\nimport lightbox from './js/lightbox';\nimport apiService from './js/api-service';\nimport fetchHandling from './js/fetch-handling';\nimport masonryService from './js/masonry-service';\nimport { infScroll } from './js/infinite-scroll';\n\ninfScroll.on('load', res => {\n  const data = fetchHandling(res);\n  apiService.result = data;\n});\n\nrefs.form.addEventListener('submit', event => {\n  event.preventDefault();\n  refs.grid.innerHTML =\n    '<div class=\"grid__col-sizer\"></div><div class=\"grid__gutter-sizer\"></div>';\n  masonryService.resetMasonry();\n  masonryService.initMasonry();\n  apiService.query = refs.input.value.toLowerCase();\n  apiService.resetResult();\n  refs.form.reset();\n  infScroll.options.resetPage();\n  infScroll.loadNextPage();\n});\n\nrefs.grid.addEventListener('click', event => {\n  event.preventDefault();\n  lightbox.showModal(event);\n});\ndocument.addEventListener('keyup', event => {\n  event.preventDefault();\n  lightbox.closeModal(event);\n});\ndocument.addEventListener('keyup', event => {\n  event.preventDefault();\n  lightbox.showNextImage(event);\n});\ndocument.addEventListener('keyup', event => {\n  event.preventDefault();\n  lightbox.showPrevImage(event);\n});\n"],"sourceRoot":""}